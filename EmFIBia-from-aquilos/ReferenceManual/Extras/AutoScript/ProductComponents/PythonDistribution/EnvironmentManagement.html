<!DOCTYPE html>
<html>
<head>
    <title>Python environment management</title>

    <link rel="stylesheet" type="text/css" href="../../../../Resources/common-style.css">
    <link rel="stylesheet" type="text/css" href="../../../../Resources/page-style.css">
    <link rel="stylesheet" type="text/css" href="../../../../Resources/page-custom-style.css">
    <link rel="stylesheet" type="text/css" href="../../../../Resources/syntax-highlight-style.css">

    <script src="../../../../Resources/common.js"></script>
    <script src="../../../../Resources/page.js"></script>
    <script src="../../../../Resources/page_jupyter_checking_ie.js"></script>
    <script src="../../../../Resources/page_jupyter_checking.js"></script>
    <script src="../../../../Resources/prism.js"></script>
    <script src="../../../../Resources/prism-normalize-whitespace.js"></script>
    <script src="../../../../Resources/prism-c.js"></script>
    <script src="../../../../Resources/prism-cpp.js"></script>
    <script src="../../../../Resources/prism-csharp.js"></script>
    <script src="../../../../Resources/prism-python.js"></script>

    <script>
        window.addEventListener('DOMContentLoaded', function() {
            onContentLoaded('../../../../shell.html');

            try {
                checkAllJupyterLinks();
            } catch(e) {
                disableAllJupyterLinks();
            };
        });

        function ScrollTo(elementId) {
            document.getElementById(elementId).scrollIntoView();
        }
    </script>
    <style>
        hr { height:2px; visibility:hidden; }
    </style>

    <!-- For old IE browsers: IE 9 and lower -->
    <!--[if IE]>
    <link rel="stylesheet" type="text/css" href="../../../../Resources/page-style-old-ie.css">
    <![endif]-->
</head>
<body>

<h1>Python environment management</h1>

In this chapter, we elaborate on the methods for creating and removing virtual environments within the Python distribution included with AutoScript.
<br><br>

The recommended method for managing virtual environments is to use the
<a href="https://docs.enthought.com/edm" target="_blank">Enthought Deployment Manager</a> (EDM) tool.
It offers a variety of built-in functions tailored for this task.
While other popular managers like <em>Venv, virtualenv, Pipenv</em>, or <em>Poetry</em> exist, they may not consistently deliver
reliable results across all scenarios when used with the Enthought-based Python distribution.
<br><br>

There are two options for managing environments:

<ol>
    <li><a href="#option1" onclick="ScrollTo('option1')">AutoScript Package Manager</a> (preferred method)</li>
    <li><a href="#option2" onclick="ScrollTo('option2')">EDM command-line interface</a></li>
</ol>

<hr id="option1"/>
<h2>1. AutoScript Package Manager</h2>

<strong>Example 1:</strong> Create a new environment "Test" and initialize it with AutoScript packages.

<ol>
    <li>
        Launch the Package Manager from the Start menu <em>Thermo Scientific AutoScript</em> &gt;
        <em>AutoScript Package Manager</em>.<br>
        On startup, the application scans the available and installed packages.
        The name of the active environment is displayed in the drop-down box <strong>(1)</strong>.
        <br><br>

        <img src="../../Resources/EnvironmentManager_Example1.png" height="278" width="1099" alt="">
        <br><br>
    </li>

    <li>
        Click on the <strong>Environment</strong> button <strong>(2)</strong> and choose <strong>Create Environment</strong>. A dialog box opens<br><br>

        <img src="../../Resources/EnvironmentManager_Example2.png" height="200" width="350" alt=""><br>

        Enter the name of the environment and click on the <strong>Create</strong> button.
        The name of the environment must be unique, and it must be a valid file name supported by the file system.<br>

        Leave the <em>'Initialize with AutoScript packages'</em> checkbox checked to install AutoScript client packages
        and all their dependencies into the newly created environment. This process may take some time,
        as the packages are downloaded from the Internet.<br><br>
    </li>

    <li>
        The environment has been created and set active. Note that the environment is only set active for the Package Manager,
        it is not a system-wide setting.<br>
     </li>
</ol>

<strong>Example 2:</strong> Remove the "Test" environment.
<ol>
    <li>
        Activate the "Test" environment by selecting it in the drop-down box <strong>(1)</strong>.
    </li>
    <li>
        Click on the <strong>Environment</strong> button <strong>(2)</strong> and choose <strong>Remove Environment</strong>.
        In the confirmation dialog, press <strong>Yes</strong>.
    </li>
</ol>

<hr id="option2"/>
<h2>2. EDM command-line interface</h2>

<strong>Example 1:</strong> Create a new environment "Test" and initialize it with AutoScript packages. Follow these steps in the <strong>AutoScript EDM Shell</strong> prompt:

<ol>
    <li>
        Create the new environment:
<pre>
edm env create Test --version 3.11
</pre>
    </li>

    <li>
        Activate the new environment:
<pre>
edm shell -e Test
</pre>
    </li>

    <li>
        Initialize the environment with minimum mandatory dependencies of the AutoScript client packages:
<pre>
edm install colorama numpy pillow_simd opencv_python matplotlib
</pre>
    </li>

    <li>
        Install the AutoScript client packages using pip. The AutoScript client packages are provided in the form of *.whl (wheel) packages.
        The files are placed in the product installation directory under <em>c:\Program Files\Thermo Scientific AutoScript\PythonPackages</em>.
<pre>
pip install "c:\Program Files\Thermo Scientific AutoScript\PythonPackages\*.whl"
</pre>
    </li>
</ol>

<br>
<strong>Example 2:</strong> Remove the "Test" environment.
<ol>
    <li>
        Activate the "AutoScript" environment:
<pre>
edm shell -e AutoScript
</pre>
    </li>

    <li>
       Delete the "Test" environment:
<pre>
edm env remove Test
</pre>
    </li>
</ol>

</body>
</html>
